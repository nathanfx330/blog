<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }} | {{ .Site.Title }}</title>
    <link rel="stylesheet" href="{{ "css/style.css" | relURL }}">
</head>
<body>
    
    {{ partial "header.html" . }}

    <main>
        {{ block "main" . }}{{ end }}
    </main>

    <!-- OUR CUSTOM LIGHTBOX HTML -->
    <div id="lightbox" class="lightbox">
      <span class="close-lightbox">&times;</span>
      <img class="lightbox-content" id="lightbox-img">
    </div>

    <!-- CORRECTED LIGHTBOX JAVASCRIPT -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const closeBtn = document.querySelector('.close-lightbox');

        // Find all figures within the post content and get the image inside
        const figures = document.querySelectorAll('.post-content figure');

        figures.forEach(figure => {
          const image = figure.querySelector('img');
          if (image) {
            figure.style.cursor = 'zoom-in'; // Make the whole figure clickable
            figure.addEventListener('click', function() {
              lightbox.style.display = 'flex';
              lightboxImg.src = image.src;
            });
          }
        });

        // Function to close the lightbox
        function closeLightbox() {
          lightbox.style.display = 'none';
        }

        // Close when clicking the 'x' or the overlay
        closeBtn.addEventListener('click', closeLightbox);
        lightbox.addEventListener('click', function(e) {
          if (e.target === lightbox) {
            closeLightbox();
          }
        });

        // Close with the Escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            closeLightbox();
          }
        });
      });
    </script>

</body>
</html>